{% load static %}

<!DOCTYPE html>
<html>
<head>
    <title>Products</title>
</head>
<body>

<h2>Products</h2>

<form method="get">
    <input type="text" name="search" placeholder="Search" value="{{ search }}">
    <select name="category">
        <option value="all">All Categories</option>
        {% for cat in categories %}
            <option value="{{ cat.id }}"
                {% if selected_category == cat.id|stringformat:"s" %}selected{% endif %}>
                {{ cat.name }}
            </option>
        {% endfor %}
    </select>
    <input type="number" name="max_price" placeholder="Max Price" value="{{ max_price }}">
    <select name="sort">
        <option value="">Sort</option>
        <option value="price_low">Price Low</option>
        <option value="price_high">Price High</option>
        <option value="newest">Newest</option>
    </select>
    <button type="submit">Apply</button>
</form>

<hr>

{% if products %}
    {% for product in products %}
        <div style="border:1px solid #ccc;padding:15px;margin-bottom:20px;">
            <h3>{{ product.name }}</h3>

            {% if product.images.first %}
                <img src="{{ product.images.first.image.url }}"
                     width="200">
            {% else %}
                <p>No image</p>
            {% endif %}

            <p>â‚¹{{ product.price }}</p>

            <a href="{% url 'product_detail' product.slug %}">
                View Product
            </a>
        </div>
    {% endfor %}
{% else %}
    <p>No products found.</p>
{% endif %}

</body>
</html>
